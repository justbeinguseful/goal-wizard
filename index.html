<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Goal Wizard + Airtable</title>
  <style>
    /* same styling as before… */
  </style>
</head>
<body>

<div id="wizard">
  <!-- Step 1 -->
  <div class="step active" data-step="1">
    <h2>Enter your goal</h2>
    <input type="text" id="goal" placeholder="e.g. Run a 5K in under 25min">
    <div class="buttons"><button id="next1">Next ➔</button></div>
  </div>
  <!-- Step 2 -->
  <div class="step" data-step="2">
    <h2>Pick a deadline</h2>
    <input type="date" id="deadline">
    <div class="buttons">
      <button id="prev2">◀ Back</button>
      <button id="next2">Next ➔</button>
    </div>
  </div>
  <!-- Step 3 -->
  <div class="step" data-step="3">
    <h2>Set your stake ($)</h2>
    <input type="number" id="stake" placeholder="e.g. 100">
    <div class="buttons">
      <button id="prev3">◀ Back</button>
      <button id="next3">Next ➔</button>
    </div>
  </div>
  <!-- Step 4 -->
  <div class="step" data-step="4">
    <h2>Supervisor’s Email</h2>
    <input type="email" id="supervisor" placeholder="supervisor@example.com">
    <div class="buttons">
      <button id="prev4">◀ Back</button>
      <button id="next4">Next ➔</button>
    </div>
  </div>
  <!-- Step 5: Review & Submit -->
  <div class="step" data-step="5">
    <h2>Review & Submit</h2>
    <p style="text-align:center;">
      <strong>Goal:</strong> <span id="review-goal"></span><br>
      <strong>Deadline:</strong> <span id="review-deadline"></span><br>
      <strong>Stake:</strong> $<span id="review-stake"></span><br>
      <strong>Supervisor:</strong> <span id="review-supervisor"></span>
    </p>
    <div class="buttons">
      <button id="prev5">◀ Back</button>
      <button id="submit">Submit ✅</button>
    </div>
  </div>
</div>

<script>
  // step navigation & populateReview (same as before)…

  // Airtable write (no Stripe!)
  const AIRTABLE_BASE  = 'appXTQ0JUx74XJmAA';
  const AIRTABLE_TABLE = 'tblyuW8pf6ZkFRfte';
  const AIRTABLE_KEY   = 'patgTL9GHvIxoQPP7.12530f311f38265eed09b5f8d9a9ed1657c7c2cc9ea5f9e923269665ae68bfa5';

  submit.onclick = async () => {
    const payload = {
      fields: {
        "Goal":            goal.value,
        "Deadline Date":   deadline.value,
        "Money Stake USD": parseFloat(stake.value),
        "Referee Email":   supervisor.value
      }
    };

    try {
      const resp = await fetch(
        `/.netlify/functions/submit-goal`,  // if you’re using the Netlify Function
        {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({
            goal: goal.value,
            deadline: deadline.value,
            stake: stake.value,
            supervisor: supervisor.value
          })
        }
      );
      if (!resp.ok) throw new Error('Network response was not ok');
      alert('🎉 Saved! We’ll follow up via email.');
      showStep(1);
      [goal,deadline,stake,supervisor].forEach(f=>f.value='');
    } catch (err) {
      console.error(err);
      alert('⚠️ Error: '+err.message);
    }
  };
</script>

</body>
</html>
